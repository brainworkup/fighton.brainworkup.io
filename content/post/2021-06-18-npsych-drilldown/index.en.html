---
authors:
- admin
categories: []
date: '2021-06-18'
draft: false
featured: false
gallery_item:
- album: gallery
  caption: Default
  image: theme-default.png
- album: gallery
  caption: Ocean
  image: theme-ocean.png
- album: gallery
  caption: Forest
  image: theme-forest.png
- album: gallery
  caption: Dark
  image: theme-dark.png
- album: gallery
  caption: Apogee
  image: theme-apogee.png
- album: gallery
  caption: 1950s
  image: theme-1950s.png
- album: gallery
  caption: Coffee theme with Playfair font
  image: theme-coffee-playfair.png
- album: gallery
  caption: Strawberry
  image: theme-strawberry.png
image:
  caption: 'Image credit: [**Unsplash**](https://unsplash.com/photos/CpkOjOcXdUY)'
  focal_point: ""
  preview_only: false
projects: []
tags: []
title: Drilldown on Neuropsych Data with R
subtitle: drilldown plot in highcharter
summary: drilldown plot in highcharter
slug: drilldown-neuropsych
lastmod: '2021-06-18T18:11:39-07:00'
keep_md: yes
---

<script src="{{< blogdown/postref >}}index.en_files/header-attrs/header-attrs.js"></script>
<script src="{{< blogdown/postref >}}index.en_files/htmlwidgets/htmlwidgets.js"></script>
<script src="{{< blogdown/postref >}}index.en_files/pymjs/pym.v1.js"></script>
<script src="{{< blogdown/postref >}}index.en_files/widgetframe-binding/widgetframe.js"></script>


<div id="highcharter-drilldown-setup" class="section level2">
<h2>Highcharter Drilldown Setup</h2>
<div id="r-markdown-chunk-options" class="section level3">
<h3>R Markdown chunk options</h3>
</div>
<div id="load-libraries" class="section level3">
<h3>Load libraries</h3>
<pre><code>## 
## Attaching package: &#39;dplyr&#39;
## The following objects are masked from &#39;package:stats&#39;:
## 
##     filter, lag
## The following objects are masked from &#39;package:base&#39;:
## 
##     intersect, setdiff, setequal, union
## Registered S3 method overwritten by &#39;quantmod&#39;:
##   method            from
##   as.zoo.data.frame zoo
## ── Attaching packages ────────────────────────────────── tidyverse 1.3.1.9000 ──
## ✓ ggplot2 3.3.4     ✓ tidyr   1.1.3
## ✓ tibble  3.1.2     ✓ stringr 1.4.0
## ── Conflicts ────────────────────────────────────────── tidyverse_conflicts() ──
## x dplyr::filter() masks stats::filter()
## x dplyr::lag()    masks stats::lag()</code></pre>
</div>
<div id="import-data" class="section level3">
<h3>Import data</h3>
</div>
</div>
<div id="drilldown-using-percentiles" class="section level2">
<h2>Drilldown using percentiles</h2>
<pre class="r"><code>colors &lt;-
  c(
    &quot;#058DC7&quot;,
    &quot;#50B432&quot;,
    &quot;#ED561B&quot;,
    &quot;#DDDF00&quot;,
    &quot;#24CBE5&quot;,
    &quot;#64E572&quot;,
    &quot;#FF9655&quot;,
    &quot;#FFF263&quot;,
    &quot;#6AF9C4&quot;
  )

colors8 &lt;-
  c(
    &quot;#058DC7&quot;,
    &quot;#50B432&quot;,
    &quot;#DDDF00&quot;,
    &quot;#24CBE5&quot;,
    &quot;#64E572&quot;,
    &quot;#FF9655&quot;,
    &quot;#FFF263&quot;,
    &quot;#6AF9C4&quot;
  )

## for Tooltip

ncogL1status &lt;- ncogL1status %&gt;%
  dplyr::mutate(
    rangep = case_when(
      y &gt;= 98 ~ &quot;Exceptionally High&quot;,
      y %in% 91:97 ~ &quot;Above Average&quot;,
      y %in% 75:90 ~ &quot;High-Average&quot;,
      y %in% 25:74 ~ &quot;Average&quot;,
      y %in% 9:24 ~ &quot;Low-Average&quot;,
      y %in% 2:8 ~ &quot;Below Average&quot;,
      y &lt; 2 ~ &quot;Exceptionally Low&quot;,
      TRUE ~ as.character(y)
    )
  )

x &lt;- c(&quot;Name&quot;, &quot;Score&quot;, &quot;Range&quot;)
y &lt;- c(&quot;{point.name}&quot;, &quot;{point.y}&quot;, &quot;{point.rangep}&quot;)
tt &lt;- tooltip_table(x, y)

# Create drilldown bar plot

frameWidget(
  highchart() %&gt;%
    hc_title(text = patient,
             style = list(fontSize = &quot;15px&quot;)) %&gt;%
    hc_add_series(
      ncogL1status,
      type = &quot;bar&quot;,
      name = &quot;Neuropsychological Test Scores&quot;,
      hcaes(x = name, y = y, color = colors8)
    ) %&gt;%
    hc_xAxis(
      type = &quot;category&quot;,
      title = list(text = &quot;Domain&quot;),
      categories = .$name
    ) %&gt;%
    hc_yAxis(
      title = list(text = &quot;Percentile&quot;),
      labels = list(format = &quot;{value} ‰&quot;)
    ) %&gt;%
    hc_tooltip(
      pointFormat = tt,
      useHTML = TRUE,
      valueDecimals = 0
    ) %&gt;%
    hc_plotOptions(
      series = list(
        colorByPoint = TRUE,
        allowPointSelect = TRUE,
        dataLabels = TRUE
      )
    ) %&gt;%
    hc_drilldown(
      allowPointDrilldown = TRUE,
      series = c(ncogL2drill, ncogL3drill, ncogL4drill)
    )
)</code></pre>
<div class="figure"><span style="display:block;" id="fig:drillp"></span>
<div id="htmlwidget-1" style="width:100%;height:100%;" class="widgetframe html-widget"></div>
<script type="application/json" data-for="htmlwidget-1">{"x":{"url":"index.en_files/figure-html//widgets/widget_drillp.html","options":{"xdomain":"*","allowfullscreen":false,"lazyload":false}},"evals":[],"jsHooks":[]}</script>
<p class="caption">
Figure 1: Drilldown Neuropsych Pct
</p>
</div>
</div>
<div id="drilldown-using-zscores" class="section level2">
<h2>Drilldown using zScores</h2>
<pre class="r"><code>colors &lt;-
  c(
    &quot;#058DC7&quot;,
    &quot;#50B432&quot;,
    &quot;#ED561B&quot;,
    &quot;#DDDF00&quot;,
    &quot;#24CBE5&quot;,
    &quot;#64E572&quot;,
    &quot;#FF9655&quot;,
    &quot;#FFF263&quot;,
    &quot;#6AF9C4&quot;
  )

colors8 &lt;-
  c(
    &quot;#058DC7&quot;,
    &quot;#50B432&quot;,
    &quot;#DDDF00&quot;,
    &quot;#24CBE5&quot;,
    &quot;#64E572&quot;,
    &quot;#FF9655&quot;,
    &quot;#FFF263&quot;,
    &quot;#6AF9C4&quot;
  )

## for Tooltip

ncogL1statusz &lt;- ncogL1statusz %&gt;%
  dplyr::mutate(
    rangez = case_when(
      y &gt;= 2 ~ &quot;Exceptionally High&quot;,
      y %in% 1.3:1.9 ~ &quot;Above Average&quot;,
      y %in% 0.7:1.2 ~ &quot;High-Average&quot;,
      y %in% -0.7:0.6 ~ &quot;Average&quot;,
      y %in% -1.3:-0.6 ~ &quot;Low-Average&quot;,
      y %in% -2:-1.4 ~ &quot;Below Average&quot;,
      y &lt; -2 ~ &quot;Exceptionally Low&quot;,
      TRUE ~ as.character(y)
    )
  )

x &lt;- c(&quot;Name&quot;, &quot;Score&quot;, &quot;Range&quot;)
y &lt;- c(&quot;{point.name}&quot;, &quot;{point.y}&quot;, &quot;{point.rangez}&quot;)
tt &lt;- tooltip_table(x, y)

# Create drilldown bar plot

frameWidget(
  highchart() %&gt;%
    hc_title(text = patient,
             style = list(fontSize = &quot;15px&quot;)) %&gt;%
    hc_add_series(
      ncogL1statusz,
      type = &quot;bar&quot;,
      name = &quot;Neuropsychological Test Scores&quot;,
      hcaes(x = name, y = y, color = colors8)
    ) %&gt;%
    hc_xAxis(
      type = &quot;category&quot;,
      title = list(text = &quot;Domain&quot;),
      categories = .$name
    ) %&gt;%
    hc_yAxis(
      title = list(text = &quot;z-score&quot;),
      labels = list(format = &quot;{value}&quot;)
    ) %&gt;%
    hc_tooltip(
      pointFormat = tt,
      useHTML = TRUE,
      valueDecimals = 0
    ) %&gt;%
    hc_plotOptions(
      series = list(
        colorByPoint = TRUE,
        allowPointSelect = TRUE,
        dataLabels = TRUE
      )
    ) %&gt;%
    hc_drilldown(
      allowPointDrilldown = TRUE,
      series = c(ncogL2drillz, ncogL3drillz, ncogL4drillz)
    )
)</code></pre>
<div class="figure"><span style="display:block;" id="fig:drillz"></span>
<div id="htmlwidget-2" style="width:100%;height:100%;" class="widgetframe html-widget"></div>
<script type="application/json" data-for="htmlwidget-2">{"x":{"url":"index.en_files/figure-html//widgets/widget_drillz.html","options":{"xdomain":"*","allowfullscreen":false,"lazyload":false}},"evals":[],"jsHooks":[]}</script>
<p class="caption">
Figure 2: Drilldown Neuropsych zScores
</p>
</div>
</div>
