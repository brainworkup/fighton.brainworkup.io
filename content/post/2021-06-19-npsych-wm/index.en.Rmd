---
authors:
- admin
categories: []
date: '2021-06-19'
draft: false
featured: false
gallery_item:
- album: gallery
  caption: Default
  image: theme-default.png
- album: gallery
  caption: Ocean
  image: theme-ocean.png
- album: gallery
  caption: Forest
  image: theme-forest.png
- album: gallery
  caption: Dark
  image: theme-dark.png
- album: gallery
  caption: Apogee
  image: theme-apogee.png
- album: gallery
  caption: 1950s
  image: theme-1950s.png
- album: gallery
  caption: Coffee theme with Playfair font
  image: theme-coffee-playfair.png
- album: gallery
  caption: Strawberry
  image: theme-strawberry.png
image:
  caption: 'Image credit: [**Unsplash**](https://unsplash.com/photos/CpkOjOcXdUY)'
  focal_point: ""
  preview_only: false
projects: []
tags: []
title: Neuropsych WM
subtitle: trying genomicsem for wm
summary: trying genomicsem for wm
slug: npsych-wm
lastmod: '2021-06-19T21:24:48-07:00'
output: distill::distill_article
---

**Insert Lead paragraph here.**

## New Cool Post

```{r setup, echo=FALSE}
knitr::opts_chunk$set(
  echo = FALSE,
  dev = c("CairoPNG", "CairoPDF"),
  dev.args = list(pointsize = 8),
  crop = TRUE,
  par = TRUE,
  fig.width = 5,
  fig.height = 3,
  dpi = 300,
  fig.pos = 'H',
  root.dir = normalizePath('./'),
  cache = FALSE,
  cache.path = './cache/report-',
  # Code block options
  eval = TRUE,
  include = TRUE,
  message = FALSE,
  warning = FALSE,
  results = 'asis',
  error = TRUE,
  echo = FALSE
)
knitr::opts_knit$set(width = 50)

options(digits = 3, warnPartialMatchArgs = FALSE)
```

## Developmental/Lifespan Trajectory of WM Skills

## Tidy Data

### Import

```{r wm, echo=F}
# path
data_path <- ("~/blogdown.brainworkup/content/post/2021-06-19-npsych-wm/dat")
# get file names of .csv files
files <- dir(data_path, pattern = "*.dat")
# read into env
wm <- files %>%
  purrr::set_names() %>%
  purrr::map_df(~ readr::read_tsv(
    file.path(data_path, .),
    col_types = cols(IID = col_character(),
                     FID = col_character()),
    na = c("", "NA", "--", "-")
  )) %>%
  dplyr::distinct() %>%
  bind_rows(.id = "filename")
wm <- as_tibble(wm)
```

### Clean with Janitor

```{r clean}
wm_clean <- wm %>% janitor::clean_names()
```

### Glimpse 1

```{r, echo=F, results='hide'}
glimpse(wm_clean)
```

## paged table

```{r}
# library(rmarkdown)
# paged_table(wm_clean, options = list(rows.print = 15, cols.print = 5))
```

### Mean dsf

```{r, layout="l-body-outset"}
library(rmarkdown)
library(dplyr)

wm_clean %>% 
    select(c(
        phe_digit_span_fwd,
        phe_digit_span_bkwd,
        phe_digit_span,
        phe_letter_number_span)) %>%
    summarize(
        mean_dsf = mean(phe_digit_span_fwd, na.rm = TRUE),
        sd_dsf = sd(phe_digit_span_fwd, na.rm = TRUE),
        n_dsf = n_distinct(phe_digit_span_fwd, na.rm = TRUE),
        mean_dsb = mean(!is.na(phe_digit_span_bkwd)),
        sd_dsb = sd(phe_digit_span_bkwd, na.rm = TRUE),
        n_dsb = n_distinct(phe_digit_span_bkwd, na.rm = TRUE),
        mean_ds = mean(phe_digit_span, na.rm = TRUE),
        sd_ds = sd(phe_digit_span, na.rm = TRUE),
        n_ds = n_distinct(phe_digit_span, na.rm = TRUE),
        mean_lns = mean(!is.na(phe_letter_number_span)),
        sd_lns = sd(phe_letter_number_span, na.rm = TRUE),
        n_lns = n_distinct(phe_letter_number_span, na.rm = TRUE),
        ) %>% 
    paged_table()
```

```{r, eval=F}
wm_clean %>% 
    select(c(
        phe_digit_span_fwd,
        phe_digit_span_bkwd,
        phe_digit_span,
        phe_letter_number_span)) %>%
    summarize(
        mean_dsf = mean(phe_digit_span_fwd, na.rm = TRUE),
        sd_dsf = sd(phe_digit_span_fwd, na.rm = TRUE),
        n_dsf = n_distinct(phe_digit_span_fwd, na.rm = TRUE),
        mean_dsb = mean(!is.na(phe_digit_span_bkwd)),
        sd_dsb = sd(phe_digit_span_bkwd, na.rm = TRUE),
        n_dsb = n_distinct(phe_digit_span_bkwd, na.rm = TRUE),
        mean_ds = mean(phe_digit_span, na.rm = TRUE),
        sd_ds = sd(phe_digit_span, na.rm = TRUE),
        n_ds = n_distinct(phe_digit_span, na.rm = TRUE),
        mean_lns = mean(!is.na(phe_letter_number_span)),
        sd_lns = sd(phe_letter_number_span, na.rm = TRUE),
        n_lns = n_distinct(phe_letter_number_span, na.rm = TRUE),
        ) %>% 
    DT::datatable(.)
```

## Create list

```{r, echo=F}
wm_list <- files %>%
  purrr::set_names() %>%
  purrr::map(~ readr::read_tsv(
    file.path(data_path, .),
    col_types = cols(IID = col_character(),
                     FID = col_character()),
    na = c("", "NA", "--", "-")))
glimpse(wm_list)
```

```{r layout="l-body-outset"}
library(rmarkdown)
    select(wm, one_of(
        "phe_digit_span_fwd",
        "phe_digit_span_bkwd",
        "phe_digit_span",
        "phe_letter_number_span")) %>%
paged_table()
#paged_table(wm_list[1], options = list(rows.print = 15, cols.print = 5))
```

```{r}
glimpse(wm_list[2])
```

```{r dt}
#DT::datatable(adni)
```

```{r form}
#formattable(adni)
```

## Genomic SEM

### Create list column

```{r}
library(tidyverse)
wm1 <- tibble::enframe(wm_list)

wm1 %>% mutate(
   type = map_chr(phe_digit_span_fwd, typeof),
   length = map_int(phe_digit_span_fwd, length)
)


wm_list %>% mutate(
   smry = map2_chr(
      name,
      value,
      ~ stringr::str_c(.x, ": ", .y[1])
   )
)
 

```

```{r}

output <- vector("double", ncol(wm))
for (i in seq_along(wm)) {
 output[[i]] <- median(wm[[i]], na.rm = TRUE)
}
output

median <- vector("double", ncol(wm))
for (i in seq_along(wm)) {
 median[[i]] <- median(wm[[i]], na.rm = TRUE)
}
median

na <- vector("double", ncol(wm))
for (i in seq_along(wm)) {
 na[[i]] <- tidyselect::contains("digit_span")
}
na


phe_wm <- wm_clean %>% select(
   contains(c(
      "filename", "fid", "iid",
      "digit_span", "number", "digit", "span", "back", "arith", "swm", "pasat", "trails_b", "lns", "letter", "nback"))) 

readr::write_csv(phe_wm, "phe_wm.csv")
glimpse(wm_list)   

```
